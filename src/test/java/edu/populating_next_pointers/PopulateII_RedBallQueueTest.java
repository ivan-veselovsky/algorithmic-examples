package edu.populating_next_pointers;

import edu.common.Node;
import org.junit.jupiter.api.Test;

import java.util.Arrays;
import java.util.Collections;

import static edu.common.NodeUtils.asHashSeparatedNodeList;
import static edu.common.NodeUtils.buildTreeFromBFS_Node;
import static org.assertj.core.api.BDDAssertions.then;

class PopulateII_RedBallQueueTest {

    @Test
    void connect() {
        Node root = buildTreeFromBFS_Node(new Integer[] { 1,2,3,4,5,null,7,
                null, null, 10, null, null, null, 14 });

        new PopulateII_RedBallQueue().connect(root);

        Integer[] list = asHashSeparatedNodeList(root);
        then(list).containsExactly(1,null,
                2,3, null,
                4,5,7,null,
                10,14, null);
    }

    @Test
    void test2() {
        Node root = buildTreeFromBFS_Node(new Integer[] { 1,5,8,9,7,7,8,1,4,8,1,  9,0,8,7,1,7,4,2,9,8,  2,4, 128,129, 9,130,131,132,
                6,0,9,4,1,0,1,8,9,0,1,8,9,1,0,9,6,2,5, 133, 2,3,0,2,4,8,8,8,5,0,0,9,4,9,1, 134, 0,7,2,2,3, 135,6,1,0,8,9,9,9,4,8,4,3,4,4,0, 136,
                137,8,3,8,137,137,0,137,0,4,9,1,2, 137, 4,4,0,4,3,5,5,7,4,1,6,137,1,0, 137, 138,138,2,8,7,7,140,142,0,2,5,5,9,3,3,
                138,7,6,6,7,9,8,1,7,7,7,2,6,999,7,999,4,6,4,6,999,999,9,1,999,999,999,5,5,5,4,2,2,8,5,1,1,3,1,3,7,999,2,999,9,1,4,4,7,7,999,1,5,6,2,7,3,999,9,1,999,2,4,4,8,999,999,7,999,6,999,7,4,3,5,8,4,8,5,999,999,8,999,999,999,4,4,999,999,999,999,8,3,5,5,999,999,999,1,2,0,999,999,9,3,999,8,3,7,1,8,9,0,1,8,2,999,4,999,999,8,999,999,999,999,2,999,4,8,5,5,3,1,999,999,6,999,1,999,999,6,999,999,999,999,7,3,999,999,999,8,6,4,999,6,9,0,7,8,999,999,0,6,7,999,999,0,0,7,2,3,2,999,0,2,3,999,0,1,7,9,0,7,999,999,999,999,5,8,2,6,3,2,0,4,999,999,0,9,1,1,1,999,1,3,999,7,9,1,3,3,8,999,999,999,999,6,999,999,999,999,9,8,1,3,8,3,0,6,999,999,8,5,6,5,2,1,999,5,999,7,0,0,999,9,3,9,999,3,0,0,9,1,7,0,2,999,6,8,5,999,999,999,999,999,7,999,2,5,999,999,9,999,999,999,999,999,999,999,999,999,999,999,4,1,999,3,6,6,2,5,5,9,999,999,7,8,999,999,2,7,3,7,2,5,999,1,3,4,999,999,8,3,6,9,999,1,999,999,999,999,9,7,5,2,999,5,999,6,4,5,999,1,2,0,6,999,1,6,999,999,5,999,7,8,4,7,8,6,4,999,5,6,7,9,1,0,4,999,999,999,6,4,8,4,5,999,0,4,4,0,1,7,1,999,1,999,3,6,999,999,999,999,8,999,5,0,7,5,999,999,5,8,999,999,3,999,999,8,999,2,4,999,999,999,999,999,999,999,9,999,9,999,9,999,999,999,999,7,1,999,999,2,999,999,5,5,5,5,6,4,999,999,1,6,4,0,999,0,6,3,0,999,5,5,999,999,999,999,2,999,3,6,999,3,0,5,0,1,0,3,4,9,9,2,7,3,8,6,9,999,5,8,999,999,999,999,9,8,0,7,999,999,8,8,6,6,0,2,7,4,2,3,8,6,4,999,8,999,999,999,2,0,999,1,3,5,4,2,2,5,8,8,999,3,0,999,1,6,0,999,999,9,999,2,999,6,8,2,999,999,5,999,999,999,9,6,6,4,2,0,999,999,1,999,0,999,999,999,6,6,999,999,999,4,7,9,999,0,1,999,999,9,999,999,999,4,999,8,999,999,999,999,999,999,4,999,6,999,3,999,999,5,1,2,5,999,0,7,8,999,7,999,999,4,999,4,4,999,2,999,6,999,999,999,7,999,999,999,999,6,4,999,6,999,6,9,999,999,999,9,6,999,9,999,3,999,2,999,7,7,999,999,0,999,6,3,999,999,999,999,999,999,1,999,999,999,6,9,7,999,7,999,9,3,3,999,999,999,999,4,999,999,3,999,999,999,3,9,999,0,3,1,9,6,7,9,4,8,999,999,6,999,1,3,7,999,999,999,3,999,2,999,8,1,1,999,999,6,999,7,3,5,999,6,3,4,999,999,5,7,1,999,999,6,4,6,999,999,999,999,5,7,0,7,0,999,5,8,5,5,4,5,999,999,999,999,999,999,1,7,999,999,7,999,9,9,6,4,999,999,3,2,1,999,0,999,0,6,999,999,999,1,5,999,999,999,8,999,999,999,999,3,4,8,999,999,9,6,4,999,999,999,999,8,9,999,1,999,999,999,7,999,999,999,999,999,9,999,999,999,4,1,6,7,0,999,999,999,7,999,999,8,999,999,999,999,999,999,999,4,999,9,999,999,999,999,3,0,6,999,5,999,9,9,999,999,4,3,4,999,999,999,999,8,999,5,999,999,999,999,5,2,999,999,999,999,999,999,999,2,999,999,2,1,8,5,999,0,999,0,3,2,4,5,999,999,999,999,999,7,999,999,0,999,0,999,999,999,0,3,9,999,999,999,999,5,999,999,0,5,0,0,999,9,999,999,999,999,999,999,999,999,8,999,9,3,5,9,0,5,9,999,999,9,4,999,0,2,0,999,999,7,999,7,999,5,7,8,7,999,999,999,3,0,3,999,999,999,999,999,4,5,999,999,2,3,999,2,999,999,7,999,999,9,999,999,9,7,1,999,999,1,6,1,8,999,999,5,999,999,3,7,9,6,999,999,999,999,1,999,999,999,3,7,3,2,3,3,999,1,999,999,999,1,999,999,4,3,4,8,7,999,0,3,0,999,1,1,999,999,999,999,999,5,999,6,0,999,3,1,999,6,999,999,4,0,1,999,6,1,999,999,9,6,4,9,0,8,9,3,3,6,999,999,999,999,999,999,999,999,999,999,999,999,2,999,999,999,999,999,8,5,8,3,5,4,999,6,999,0,999,999,6,999,4,3,999,999,999,999,999,999,999,999,999,999,999,999,999,999,7,3,999,999,1,999,2,4,999,999,999,6,999,999,999,6,999,5,999,999,999,999,1,999,999,3,999,1,999,7,1,999,999,7,1,3,4,8,999,999,999,999,999,4,999,999,4,999,999,999,7,999,6,999,999,1,999,999,999,7,3,3,999,999,999,999,3,0,999,999,4,999,999,999,999,999,999,999,999,999,999,8,999,999,9,999,999,6,6,5,2,999,8,3,8,999,999,999,999,6,7,0,999,999,999,999,1,1,5,999,0,5,999,5,999,999,999,1,2,999,2,9,1,999,2,4,1,999,999,999,1,8,4,4,5,2,999,999,6,4,7,5,2,9,999,4,999,999,999,999,999,3,999,999,5,9,999,999,999,999,9,999,9,999,999,999,2,999,1,9,999,999,999,999,999,1,9,3,999,999,1,9,999,5,2,1,0,999,999,1,9,8,4,7,999,999,5,7,999,999,999,999,1,2,8,999,6,0,999,999,999,999,0,999,999,999,6,999,2,3,0,9,999,999,1,4,6,999,8,999,999,5,999,3,0,999,6,999,999,999,999,999,2,999,999,999,999,999,999,2,5,8,6,9,999,999,999,8,999,999,9,6,999,999,999,999,3,999,999,999,999,9,999,999,2,999,999,999,999,999,999,8,8,999,999,999,999,999,9,999,6,999,2,5,999,999,1,2,999,4,999,999,4,999,999,3,5,999,3,3,999,999,1,999,999,999,999,4,999,2,3,999,4,5,3,999,7,999,999,999,7,6,999,999,1,3,999,4,9,8,999,999,0,999,3,4,999,8,999,1,999,999,2,2,999,999,4,999,999,999,3,999,999,2,999,999,999,4,999,5,999,999,999,999,2,999,5,999,999,999,999,999,999,2,7,5,999,6,999,999,999,999,2,999,0,999,3,999,1,999,9,4,999,3,999,999,999,999,999,999,999,5,5,7,999,999,1,999,4,6,999,999,999,2,999,5,9,0,6,2,999,999,999,999,999,999,999,999,999,999,999,999,5,999,7,999,2,9,999,999,1,999,999,999,1,6,999,6,999,999,0,8,999,4,999,999,999,999,4,999,999,0,999,6,0,999,999,999,4,999,999,999,999,999,0,999,999,999,999,999,999,999,999,999,999,999,999,0,5,4,2,6,4,5,3,4,
                null,null,5,null,null,null,null,4,null,null,3,6,2,0,null,6,6,null,null,null,null,0,6,null,null,null,3,9,4,null,null,null,null,null,0,null,null,6,7,0,null,9,2,
                null,3,3,null,null,8,null,3,null,null,null,8,5,3,null,2,4,null,9,6,9,null,null,null,null,6,null,6,null,5,3,null,null,null,null,4,null,null,null,9,0,9,7,1,1,null,1,null,1,6,null,5,null,6,null,null,1,null,null,null,null,null,null,5,null,null,null,null,null,3,null,6,1,null,0,2,null,null,0,null,null,0,null,null,null,null,null,3,null,null,8,null,null,5,3,3,null,null,null,null,null,null,null,3,null,null,0,8,7,null,null,8,1,null,null,null,
                null,null,null,7,null,null,null,null,null,null,null,null,null,null,null,5,2,null,2,6,null,null,null,null,null,null,null,1,5,0,null,null,2,null,7,null,null,6,null,null,null,null,null,null,null,null,null,null,
                null,null,null,8,null,null,null,null,3,null,null,4,null,null,2,null,null,null,null,0,3,null,null,null,null,null,7,null,8,null,null,null,null,8,5,null,3,4,null,null,null,8,null,null,null,null,null,null,null,null,null,3,7,null,null,null,4,0,3,null,null,6,null,null,null,null,null,null,null,null,null,null,null,null,8,null,null,null,null,null,2,null,null,null,null,null,null,null,null,null,0,null,null,null,2,null,null,
                null,8,2,null,null,null,null,null,null,null,8,null,null,null,null,null,null,null,null,null,null,2,null,null,null,2,5,null,null,null,null,null,null,null,null,
                null,null,null,2,null,null,null,null,null,8,null,null,null,null,null,null,null,null,null,null,0,5 });

        new PopulateII_RedBallQueue().connect(root);

        Integer[] list = asHashSeparatedNodeList(root);

        then(list).containsExactly(
                1, null, 5, 8, null, 9, 7, 7, 8, null, 1, 4, 8, 1, 9, 0, 8, 7, null, 1, 7, 4, 2, 9, 8, 2, 4, 128, 129, 9, 130, 131, 132, 6, 0, null, 9, 4, 1, 0, 1, 8, 9, 0, 1, 8, 9, 1, 0, 9, 6, 2, 5, 133, 2, 3, 0, 2, 4, 8, 8, 8, 5, 0, 0, 9, 4, 9, null, 1, 134, 0, 7, 2, 2, 3, 135, 6, 1, 0, 8, 9, 9, 9, 4, 8, 4, 3, 4, 4, 0, 136, 137, 8, 3, 8, 137, 137, 0, 137, 0, 4, 9, 1, 2, 137, 4, 4, 0, 4, 3, 5, 5, 7, 4, 1, 6, 137, 1, 0, 137, 138, 138, 2, 8, 7, 7, 140, 142, 0, 2, 5, 5, null, 9, 3, 3, 138, 7, 6, 6, 7, 9, 8, 1, 7, 7, 7, 2, 6, 999, 7, 999, 4, 6, 4, 6, 999, 999, 9, 1, 999, 999, 999, 5, 5, 5, 4, 2, 2, 8, 5, 1, 1, 3, 1, 3, 7, 999, 2, 999, 9, 1, 4, 4, 7, 7, 999, 1, 5, 6, 2, 7, 3, 999, 9, 1, 999, 2, 4, 4, 8, 999, 999, 7, 999, 6, 999, 7, 4, 3, 5, 8, 4, 8, 5, 999, 999, 8, 999, 999, 999, 4, 4, 999, 999, 999, 999, 8, 3, 5, 5, 999, 999, 999, 1, 2, 0, 999, 999, 9, 3, 999, 8, 3, 7, 1, 8, 9, 0, 1, 8, 2, 999, 4, 999, 999, 8, 999, 999, 999, 999, null, 2, 999, 4, 8, 5, 5, 3, 1, 999, 999, 6, 999, 1, 999, 999, 6, 999, 999, 999, 999, 7, 3, 999, 999, 999, 8, 6, 4, 999, 6, 9, 0, 7, 8, 999, 999, 0, 6, 7, 999, 999, 0, 0, 7, 2, 3, 2, 999, 0, 2, 3, 999, 0, 1, 7, 9, 0, 7, 999, 999, 999, 999, 5, 8, 2, 6, 3, 2, 0, 4, 999, 999, 0, 9, 1, 1, 1, 999, 1, 3, 999, 7, 9, 1, 3, 3, 8, 999, 999, 999, 999, 6, 999, 999, 999, 999, 9, 8, 1, 3, 8, 3, 0, 6, 999, 999, 8, 5, 6, 5, 2, 1, 999, 5, 999, 7, 0, 0, 999, 9, 3, 9, 999, 3, 0, 0, 9, 1, 7, 0, 2, 999, 6, 8, 5, 999, 999, 999, 999, 999, 7, 999, 2, 5, 999, 999, 9, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 4, 1, 999, 3, 6, 6, 2, 5, 5, 9, 999, 999, 7, 8, 999, 999, 2, 7, 3, 7, 2, 5, 999, 1, 3, 4, 999, 999, 8, 3, 6, 9, 999, 1, 999, 999, 999, 999, 9, 7, 5, 2, 999, 5, 999, 6, 4, 5, 999, 1, 2, 0, 6, 999, 1, 6, 999, 999, 5, 999, 7, 8, 4, 7, 8, 6, 4, 999, 5, 6, 7, 9, 1, 0, 4, 999, 999, 999, 6, 4, 8, 4, 5, 999, 0, 4, 4, 0, 1, 7, 1, 999, 1, 999, 3, 6, 999, 999, null, 999, 999, 8, 999, 5, 0, 7, 5, 999, 999, 5, 8, 999, 999, 3, 999, 999, 8, 999, 2, 4, 999, 999, 999, 999, 999, 999, 999, 9, 999, 9, 999, 9, 999, 999, 999, 999, 7, 1, 999, 999, 2, 999, 999, 5, 5, 5, 5, 6, 4, 999, 999, 1, 6, 4, 0, 999, 0, 6, 3, 0, 999, 5, 5, 999, 999, 999, 999, 2, 999, 3, 6, 999, 3, 0, 5, 0, 1, 0, 3, 4, 9, 9, 2, 7, 3, 8, 6, 9, 999, 5, 8, 999, 999, 999, 999, 9, 8, 0, 7, 999, 999, 8, 8, 6, 6, 0, 2, 7, 4, 2, 3, 8, 6, 4, 999, 8, 999, 999, 999, 2, 0, 999, 1, 3, 5, 4, 2, 2, 5, 8, 8, 999, 3, 0, 999, 1, 6, 0, 999, 999, 9, 999, 2, 999, 6, 8, 2, 999, 999, 5, 999, 999, 999, 9, 6, 6, 4, 2, 0, 999, 999, 1, 999, 0, 999, 999, 999, 6, 6, 999, 999, 999, 4, 7, 9, 999, 0, 1, 999, 999, 9, 999, 999, 999, 4, 999, 8, 999, 999, 999, 999, 999, 999, 4, 999, 6, 999, 3, 999, 999, 5, 1, 2, 5, 999, 0, 7, 8, 999, 7, 999, 999, 4, 999, 4, 4, 999, 2, 999, 6, 999, 999, 999, 7, 999, 999, 999, 999, 6, 4, 999, 6, 999, 6, 9, 999, 999, 999, 9, 6, 999, 9, 999, 3, 999, 2, 999, 7, 7, 999, 999, 0, 999, 6, 3, 999, 999, 999, 999, 999, 999, 1, 999, 999, 999, 6, 9, 7, 999, 7, 999, 9, 3, 3, 999, 999, 999, 999, 4, 999, 999, 3, 999, 999, 999, 3, 9, 999, 0, 3, 1, 9, 6, 7, 9, 4, 8, 999, 999, 6, 999, 1, 3, 7, 999, 999, 999, 3, 999, 2, 999, 8, 1, 1, 999, 999, 6, 999, 7, 3, 5, 999, 6, 3, 4, 999, 999, 5, 7, 1, 999, 999, 6, 4, 6, 999, 999, 999, 999, 5, 7, 0, 7, 0, 999, 5, 8, 5, 5, 4, 5, 999, 999, 999, 999, 999, 999, 1, 7, 999, 999, 7, 999, 9, 9, 6, 4, 999, 999, 3, 2, 1, 999, 0, 999, 0, 6, 999, 999, 999, 1, 5, 999, 999, 999, 8, 999, 999, 999, 999, 3, 4, 8, 999, 999, 9, 6, 4, 999, 999, 999, 999, 8, 9, 999, 1, 999, 999, 999, 7, 999, 999, 999, 999, 999, 9, 999, 999, 999, 4, 1, 6, 7, 0, 999, 999, 999, 7, 999, 999, 8, 999, 999, 999, 999, 999, 999, 999, 4, 999, 9, 999, 999, 999, 999, 3, 0, 6, 999, 5, 999, 9, 9, 999, 999, 4, 3, 4, 999, 999, 999, 999, 8, 999, 5, 999, 999, 999, 999, 5, 2, 999, 999, 999, 999, 999, 999, 999, 2, 999, 999, 2, 1, 8, 5, 999, 0, 999, 0, 3, 2, 4, 5, 999, 999, 999, 999, 999, 7, 999, 999, 0, 999, 0, 999, 999, 999, 0, 3, 9, 999, null, 999, 999, 999, 5, 999, 999, 0, 5, 0, 0, 999, 9, 999, 999, 999, 999, 999, 999, 999, 999, 8, 999, 9, 3, 5, 9, 0, 5, 9, 999, 999, 9, 4, 999, 0, 2, 0, 999, 999, 7, 999, 7, 999, 5, 7, 8, 7, 999, 999, 999, 3, 0, 3, 999, 999, 999, 999, 999, 4, 5, 999, 999, 2, 3, 999, 2, 999, 999, 7, 999, 999, 9, 999, 999, 9, 7, 1, 999, 999, 1, 6, 1, 8, 999, 999, 5, 999, 999, 3, 7, 9, 6, 999, 999, 999, 999, 1, 999, 999, 999, 3, 7, 3, 2, 3, 3, 999, 1, 999, 999, 999, 1, 999, 999, 4, 3, 4, 8, 7, 999, 0, 3, 0, 999, 1, 1, 999, 999, 999, 999, 999, 5, 999, 6, 0, 999, 3, 1, 999, 6, 999, 999, 4, 0, 1, 999, 6, 1, 999, 999, 9, 6, 4, 9, 0, 8, 9, 3, 3, 6, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 2, 999, 999, 999, 999, 999, 8, 5, 8, 3, 5, 4, 999, 6, 999, 0, 999, 999, 6, 999, 4, 3, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 7, 3, 999, 999, 1, 999, 2, 4, 999, 999, 999, 6, 999, 999, 999, 6, 999, 5, 999, 999, 999, 999, 1, 999, 999, 3, 999, 1, 999, 7, 1, 999, 999, 7, 1, 3, 4, 8, 999, 999, 999, 999, 999, 4, 999, 999, 4, 999, 999, 999, 7, 999, 6, 999, 999, 1, 999, 999, 999, 7, 3, 3, 999, 999, 999, 999, 3, 0, 999, 999, 4, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 8, 999, 999, 9, 999, 999, 6, 6, 5, 2, 999, 8, 3, 8, 999, 999, 999, 999, 6, 7, 0, 999, 999, 999, 999, 1, 1, 5, 999, 0, 5, 999, 5, 999, 999, 999, 1, 2, 999, 2, 9, 1, 999, 2, 4, 1, 999, 999, 999, 1, 8, 4, 4, 5, 2, 999, 999, 6, 4, 7, 5, 2, 9, 999, 4, 999, 999, 999, 999, 999, 3, 999, 999, 5, 9, 999, 999, 999, 999, 9, 999, 9, 999, 999, 999, 2, 999, 1, 9, 999, 999, 999, 999, 999, 1, 9, 3, 999, 999, 1, 9, 999, 5, 2, 1, 0, 999, 999, 1, 9, 8, 4, 7, 999, 999, 5, 7, 999, 999, 999, 999, 1, 2, 8, 999, 6, 0, 999, 999, 999, 999, 0, 999, 999, 999, 6, 999, 2, 3, 0, 9, 999, 999, 1, 4, 6, 999, 8, 999, 999, 5, 999, 3, 0, 999, 6, 999, 999, 999, 999, 999, 2, 999, 999, 999, 999, 999, 999, 2, 5, 8, 6, 9, 999, 999, 999, 8, 999, 999, 9, 6, 999, 999, 999, 999, 3, 999, 999, 999, 999, 9, 999, 999, 2, 999, 999, 999, 999, 999, 999, 8, 8, 999, 999, 999, 999, 999, 9, 999, 6, 999, 2, 5, 999, 999, 1, 2, 999, 4, 999, 999, 4, 999, 999, 3, 5, 999, 3, 3, 999, 999, 1, 999, 999, 999, 999, 4, 999, 2, 3, 999, 4, 5, 3, 999, 7, 999, 999, 999, 7, 6, 999, 999, 1, 3, 999, 4, 9, 8, 999, 999, 0, 999, 3, 4, 999, 8, 999, 1, 999, 999, 2, 2, 999, 999, 4, 999, 999, 999, 3, 999, 999, 2, 999, 999, 999, 4, 999, 5, 999, 999, 999, 999, 2, 999, 5, 999, 999, 999, 999, 999, 999, 2, 7, 5, 999, 6, 999, 999, 999, 999, 2, 999, 0, 999, 3, 999, 1, 999, 9, 4, 999, 3, 999, 999, 999, 999, 999, 999, 999, 5, 5, 7, 999, 999, 1, 999, 4, 6, 999, 999, 999, 2, 999, 5, 9, 0, 6, 2, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 5, 999, 7, 999, 2, 9, 999, 999, 1, 999, 999, 999, 1, 6, 999, 6, 999, 999, 0, 8, 999, 4, 999, 999, 999, 999, 4, 999, 999, 0, 999, 6, 0, 999, 999, 999, 4, 999, 999, 999, 999, 999, 0, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 999, 0, 5, 4, 2, 6, 4, 5, 3, 4, 5, 4, 3, 6, 2, 0, 6, 6, 0, 6, 3, 9, 4, 0, 6, 7, 0, 9, 2, 3, 3, 8, 3, 8, 5, 3, 2, 4, 9, 6, 9, 6, 6, 5, 3, 4, 9, 0, 9, 7, 1, 1, 1, 1, 6, 5, 6, 1, 5, 3, 6, 1, 0, 2, 0, 0, 3, 8, 5, 3, 3, 3, 0, 8, 7, 8, 1, 7, 5, 2, 2, 6, 1, 5, 0, 2, 7, 6, 8, 3, 4, 2, 0, 3, 7, 8, 8, 5, 3, 4, 8, 3, 7, 4, 0, 3, 6, 8, 2, 0, 2, 8, 2, null, 8, 2, 2, 5, 2, 8, 0, 5, null
        );
    }
}